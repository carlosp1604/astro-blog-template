---
import CategoriesLayout from '@/layouts/CategoriesLayout.astro'
import CategoryCardGallery from '@/components/CategoryCardGallery.astro'
import { i18nConfig } from '@/config/i18n.config'
import { loadCategoriesPage } from '@/modules/Category/Infrastructure/Frontend/CategoriesPageLoader'

export async function getStaticPaths() {
  const paths = []

  for (const locale of i18nConfig.locales) {
    paths.push({ params: { lang: locale } })
  }

  return paths
}

const loadPageResult = await loadCategoriesPage(Astro)

if (loadPageResult instanceof Response) {
  return loadPageResult
}

const { pageTitle, pageDescription, lang, categories, pagination } = loadPageResult
---

<CategoriesLayout pagination={pagination} lang={lang} >
  <div class="page-container flex flex-col gap-6 py-5 md:py-10">
    <h1 class="heading-1">
      {pageTitle}
    </h1>
    <p class="text-lead">
      {pageDescription}
    </p>
    <CategoryCardGallery
      lang={lang}
      categories={categories}
    />
  </div>
</CategoriesLayout>
