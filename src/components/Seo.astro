---
export interface Hreflang {
    lang: string
    url: string
}

interface Props {
    title: string
    description: string
    canonical: string
    lang: string
    hreflangs?: Array<Hreflang>
    ogImage?: string
    type?: 'website' | 'article'
    publishedTime?: string
    modifiedTime?: string
    author?: string
    tags?: Array<string>
    siteName?: string
}

const {
    title,
    description,
    canonical,
    lang,
    hreflangs = [],
    ogImage = '/default-og.png',
    type = 'website',
    publishedTime,
    modifiedTime,
    author,
    tags = [],
    siteName = 'TuBlog'
} = Astro.props

const jsonLd =
    type === 'article'
        ? {
            '@context': 'https://schema.org',
            '@type': 'Article',
            headline: title,
            description,
            author: author ? { '@type': 'Person', name: author } : undefined,
            datePublished: publishedTime,
            dateModified: modifiedTime,
            mainEntityOfPage: { '@type': 'WebPage', '@id': canonical },
            image: ogImage
        }
        : {
            '@context': 'https://schema.org',
            '@type': 'WebSite',
            name: siteName,
            url: canonical,
            description
        }
---

<title>{title}</title>
<meta name="description" content={description} />
<meta name="robots" content="index,follow" />
<link rel="canonical" href={canonical} />

<!-- Open Graph -->
<meta property="og:title" content={title} />
<meta property="og:description" content={description} />
<meta property="og:type" content={type} />
<meta property="og:url" content={canonical} />
<meta property="og:locale" content={lang} />
<meta property="og:site_name" content={siteName} />
<meta property="og:image" content={ogImage} />

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content={title} />
<meta name="twitter:description" content={description} />
<meta name="twitter:image" content={ogImage} />

<!-- Hreflangs -->
{hreflangs.map((h) => (
<link rel="alternate" hreflang={h.lang} href={h.url} />
    ))}
<link rel="alternate" hreflang="x-default" href={canonical} />

<!-- Article extra -->
{type === 'article' && (
<>
    {publishedTime && <meta property="article:published_time" content={publishedTime} />}
    {modifiedTime && <meta property="article:modified_time" content={modifiedTime} />}
    {author && <meta property="article:author" content={author} />}
    {tags.map((tag) => (
      <meta property="article:tag" content={tag} />
    ))}
</>
    )}

<!-- JSON-LD structured data -->
<script is:inline type="application/ld+json" set:html={JSON.stringify(jsonLd, null, 2)} />
